<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用windows安装包安装 Elasticsearch | ElasticSearch 7.7 权威指南中文版</title>
	<meta name="keywords" content="ElasticSearch 权威指南中文版, elasticsearch 7, es7, 实时数据分析，实时数据检索" />
    <meta name="description" content="ElasticSearch 权威指南中文版, elasticsearch 7, es7, 实时数据分析，实时数据检索" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	<link rel="stylesheet" type="text/css" href="../static/styles.css" />
	<script>
	var _link = 'windows.html';
    </script>
</head>
<body>
<div class="main-container">
    <section id="content">
        <div class="content-wrapper">
            <section id="guide" lang="zh_cn">
                <div class="container">
                    <div class="row">
                        <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                            <div style="color:gray; word-break: break-all; font-size:12px;">原英文版地址: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.7/windows.html" rel="nofollow" target="_blank">https://www.elastic.co/guide/en/elasticsearch/reference/7.7/windows.html</a>, 原文档版权归 www.elastic.co 所有<br/>本地英文版地址: <a href="../en/windows.html" rel="nofollow" target="_blank">../en/windows.html</a></div>
                        <!-- start body -->
                  <div class="page_header">
<strong>重要</strong>: 此版本不会发布额外的bug修复或文档更新。最新信息请参考 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" rel="nofollow">当前版本文档</a>。
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch 权威指南 [7.7]</a></span>
»
<span class="breadcrumb-link"><a href="setup.html">设置和安装</a></span>
»
<span class="breadcrumb-link"><a href="install-elasticsearch.html">安装 Elasticsearch</a></span>
»
<span class="breadcrumb-node">使用windows安装包安装 Elasticsearch</span>
</div>
<div class="navheader">
<span class="prev">
<a href="rpm.html">« 使用RPM安装包安装 Elasticsearch</a>
</span>
<span class="next">
<a href="docker.html">用Docker安装 Elasticsearch »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title">
<a id="windows"></a>
使用windows安装包安装 Elasticsearch
</h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>
此功能目前处于 beta 测试阶段，可能会有变化。  

设计和代码不如官方的 GA 功能成熟，而且是按原样提供的，没有保障。  

Beta版特性不受官方 GA 特性的 SLA 支持。
</p>
</div>
</div>
<p>
<code class="literal">msi</code> 安装包适合在 Windows 上安装 Elasticsearch。

这可以将 Elasticsearch 安装为 Windows 服务，或者允许使用内含的可执行文件 <code class="literal">elasticsearch.exe</code>手动运行之。
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>
Elasticsearch 历史上一直使用 <a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">.zip</a> 存档安装。

如果你愿意，你可以继续使用 <code class="literal">.zip</code> 方法。
</p>
</div>
</div>
<p>
此软件包可在 Elastic 许可下免费使用。

它包含开放源码和免费的商业特性，并能访问付费商业特性。

<a href="https://www.elastic.co/guide/en/kibana/7.7/managing-licenses.html" class="ulink" target="_top">开始为期30天的试用</a> 尝试使用付费的商业特性。

有关 Elastic 许可等级的更多信息，请参考 <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">订阅（Subscriptions）</a> 页面。
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>
在Windows上，Elasticsearch 的机器学习特性需要 Microsoft Universal C Runtime 库。

这个库内置在 Windows10， Windows Server 2016 以及更近期的Windows版本。

对于更老版本的Windows，可以通过 Windows Update安装，或者 <a href="https://support.microsoft.com/en-us/help/2999226/update-for-universal-c-runtime-in-windows" class="ulink" target="_top">单独下载</a> 页面。

如果你无法安装 Microsoft Universal C Runtime 库，只要你停用机器学习特性，你仍然可以使用Elasticsearch的其他功能。
</p>
</div>
</div>
<p>
Elasticsearch 最新的稳定版本可以在 <a href="https://www.elastic.co/downloads/elasticsearch" class="ulink" target="_top">下载 Elasticsearch</a> 页面找到。

其他版本可以在 <a href="https://www.elastic.co/downloads/past-releases" class="ulink" target="_top">过去发布的版本(Past Releases)</a> 页面上找到。
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>
Elasticsearch 包含了一个绑定版本的 <a href="http://openjdk.java.net" class="ulink" target="_top">OpenJDK</a>，它来自 JDK 维护者(GPLv2+CE)。

要使用你自己的Java版本，参考 <a class="xref" href="setup.html#jvm-version" title="Java (JVM) Version">JVM 版本要求</a>。
</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="download-msi"></a>
下载 <code class="literal">.msi</code> 安装包
</h3>
</div></div></div>
<p>
从 <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.1.msi" class="ulink" target="_top">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.7.1.msi</a> 下载 lasticsearch v7.7.1 版本的 <code class="literal">.msi</code> 安装包。
</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="install-msi-gui"></a>
使用图形用户界面(GUI)安装
</h3>
</div></div></div>
<p>
双击下载的 <code class="literal">.msi</code> 安装包来启动一个 GUI 向导，该向导将指导你完成安装过程。

你可以单击 <code class="literal">?</code> 按钮，它会显示一个侧面板，其中包含每个输入的附加信息:
</p>
<div id="msi-installer-help" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_help.png" alt="msi installer help">
</div>
</div>
<p>
在第一屏中，选择安装目录。

此外，选择放置数据、日志和配置的目录，或 <a class="xref" href="windows.html#msi-command-line-options" title="Command line options">使用默认位置</a>:
</p>
<div id="msi-installer-locations" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_locations.png" alt="msi installer locations">
</div>
</div>
<p>
然后根据需要选择是安装为服务还是手动启动 Elasticsearch。

作为服务安装时，你还可以设置运行服务的 Windows 帐户、服务是否应在安装后启动，以及随 Windows 启动:
</p>
<div id="msi-installer-service" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_service.png" alt="msi installer service">
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>
选择运行服务的 Windows 帐户时，请确保所选帐户有足够的权限访问所选的安装目录和其他部署目录。

还要确保该帐户能够运行 Windows 服务。
</p>
</div>
</div>
<p>
常见配置设置显示在 Configuration 部分，除了内存和网络设置之外，还允许设置群集名称、节点名称和角色:
</p>
<div id="msi-installer-configuration" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_configuration.png" alt="msi installer configuration">
</div>
</div>
<p>
作为安装的一部分，提供了一个可以下载和安装的常见插件列表，可以选择配置一个 HTTPS 代理来下载这些插件。
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>
确保安装机器可以访问互联网，并且公司的任意一个防火墙都配置为允许从 <code class="literal">artifacts.elastic.co</code> 下载：
</p>
</div>
</div>
<div id="msi-installer-selected-plugins" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_selected_plugins.png" alt="msi installer selected plugins">
</div>
</div>
<p>
从 6.3.0 版本开始，X-Pack 是 <a href="https://www.elastic.co/products/x-pack/open" class="ulink" target="_top">默认安装</a> 的。

除了安全配置和内置用户配置之外，最后一步允许选择要安装的许可证类型:
</p>
<div id="msi-installer-xpack" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_xpack.png" alt="msi installer xpack">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>
X-Pack 包含一个 Trail（试用）或 基本（Basic）许可证。

Trail（试用）许可证可以使用 30 天，之后你可以获得一个可用的订阅。

基本（Basic）许可证是永久免费的。

有关哪个许可证下有哪些可用的特性的更多信息，请参考 <a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">可用的订阅</a> 页面。
</p>
</div>
</div>
<p>
点击安装按钮后，安装就开始了：
</p>
<div id="msi-installer-installing" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_installing.png" alt="msi installer installing">
</div>
</div>
<p>
... 安装成功后会显示如下:
</p>
<div id="msi-installer-success" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_success.png" alt="msi installer success">
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="install-msi-command-line"></a>
使用命令行安装
</h3>
</div></div></div>
<p>
还可以从命令行执行 <code class="literal">.msi</code> 来安装 Elasticsearch。

使用与图形用户界面相同的默认值的最简单的安装是先进入下载目录，然后运行命令:
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">msiexec.exe /i elasticsearch-7.7.1.msi /qn</pre>
</div>
<p>
默认情况下，<code class="literal">msiexec.exe</code> 不会等到安装程序执行完成，因为它是运行在 Windows子系统下的。

要等待进程完成并确保 <code class="literal">%ERRORLEVEL%</code> 被相应地设置，建议使用 <code class="literal">start /wait</code> 创建一个进程并等待它退出。
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /i elasticsearch-7.7.1.msi /qn</pre>
</div>
<p>
与任意一个 MSI 安装包一样，安装过程的日志文件可以在<code class="literal">%TEMP%</code>目录中找到，随机生成的日志文件名遵循 <code class="literal">MSI&lt;random&gt;.LOG</code> 格式。

可以使用命令行参数 <code class="literal">/l</code> 显示日志文件的路径：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /i elasticsearch-7.7.1.msi /qn /l install.log</pre>
</div>
<p>
可以使用下面的命令行来显示所有支持的 Windows Installer 的命令行参数：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">msiexec.exe /help</pre>
</div>
<p>
...或者参考 <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa367988(v=vs.85).aspx" class="ulink" target="_top">Windows Installer开发套件命令行选项</a>。
</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="msi-command-line-options"></a>
命令行选项
</h3>
</div></div></div>
<p>
GUI 中显示的所有设置也可以作为命令行参数(在Windows Installer文档中称为<em>properties</em>)使用，这些参数可以传递给 <code class="literal">msiexec.exe</code>:
</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col>
<col>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">INSTALLDIR</code>
</p>
</td>
<td valign="top">
<p>
安装目录。
路径中最后一个目录 <span class="strong strong"><strong>必须</strong></span> 是 Elasticsearch 的版本。

默认为 <code class="literal">%ProgramW6432%\Elastic\Elasticsearch\7.7.1</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">DATADIRECTORY</code>
</p>
</td>
<td valign="top">
<p>
数据存储的目录。

默认为 <code class="literal">%ALLUSERSPROFILE%\Elastic\Elasticsearch\data</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">CONFIGDIRECTORY</code>
</p>
</td>
<td valign="top">
<p>
配置存放的目录。

默认为 <code class="literal">%ALLUSERSPROFILE%\Elastic\Elasticsearch\config</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">LOGSDIRECTORY</code>
</p>
</td>
<td valign="top">
<p>
日志存放的目录。

默认为 <code class="literal">%ALLUSERSPROFILE%\Elastic\Elasticsearch\logs</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">PLACEWRITABLELOCATIONSINSAMEPATH</code>
</p>
</td>
<td valign="top">
<p>
数据、配置和日志目录是否应该创建在安装目录下。

默认 <code class="literal">false</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">INSTALLASSERVICE</code>
</p>
</td>
<td valign="top">
<p>
是否要将 Elasticsearch 安装并配置为 Windows 服务。

默认 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">STARTAFTERINSTALL</code>
</p>
</td>
<td valign="top">
<p>
是否在安装完成后启动 Windows 服务。默认 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">STARTWHENWINDOWSSTARTS</code>
</p>
</td>
<td valign="top">
<p>
是否在 Windows 启动时启动 这个服务。

默认 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">USELOCALSYSTEM</code>
</p>
</td>
<td valign="top">
<p>
安装的服务是否以本地系统账号(LocalSystem Account)运行。

默认 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">USENETWORKSERVICE</code>
</p>
</td>
<td valign="top">
<p>
安装的服务是否以 网络服务账号(NetworkService Account)运行。

默认 <code class="literal">false</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">USEEXISTINGUSER</code>
</p>
</td>
<td valign="top">
<p>
安装的服务是否以 一个指定的已有的账号 运行。

默认 <code class="literal">false</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">USER</code>
</p>
</td>
<td valign="top">
<p>
安装的Windows服务运行的账号名称。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">PASSWORD</code>
</p>
</td>
<td valign="top">
<p>
安装的Windows服务运行的账号的密码。
 
默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">CLUSTERNAME</code>
</p>
</td>
<td valign="top">
<p>
集群名称。

默认为 <code class="literal">elasticsearch</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">NODENAME</code>
</p>
</td>
<td valign="top">
<p>
节点名称。默认为 <code class="literal">%COMPUTERNAME%</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">MASTERNODE</code>
</p>
</td>
<td valign="top">
<p>
Elasticsearch 是否被配置为 主节点(master node)。

默认为 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">DATANODE</code>
</p>
</td>
<td valign="top">
<p>
Elasticsearch 是否被配置为 数据节点(data node)。

默认为 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">INGESTNODE</code>
</p>
</td>
<td valign="top">
<p>
Elasticsearch 是否被配置为 预处理节点(ingest node)。

默认 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">SELECTEDMEMORY</code>
</p>
</td>
<td valign="top">
<p>
给 Elasticsearch 的 JVM 堆分配的内存大小。

默认 <code class="literal">2048</code>，如果目标机器的总内存少于 4GB 则 此默认值为 总内存的50%。
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">LOCKMEMORY</code>
</p>
</td>
<td valign="top">
<p>
是否应该使用 <code class="literal">bootstrap.memory_lock</code> 来尝试 进程地址空间(process address space) 锁定到RAM。

默认为 <code class="literal">false</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">UNICASTNODES</code>
</p>
</td>
<td valign="top">
<p>
用于 单播发现(unicast discovery) 的一个逗号分割的主机列表，格式为 <code class="literal">host:port</code> 或 <code class="literal">host</code>。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">MINIMUMMASTERNODES</code>
</p>
</td>
<td valign="top">
<p>
为了形成集群，必须可见的符合主节点的最小节点数量。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">NETWORKHOST</code>
</p>
</td>
<td valign="top">
<p>
绑定到此节点的主机名或IP地址，并会<em>发布(publish)</em>(公告,advertise)到集群中的其他节点的主机。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">HTTPPORT</code>
</p>
</td>
<td valign="top">
<p>
通过 HTTP 公开 Elasticsearch API 服务的端口。

默认为 <code class="literal">9200</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">TRANSPORTPORT</code>
</p>
</td>
<td valign="top">
<p>
集群的节点之间进行内部沟通的端口。

默认为 <code class="literal">9300</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">PLUGINS</code>
</p>
</td>
<td valign="top">
<p>
安装时选择要下载和安装的插件列表，以逗号分割。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">HTTPSPROXYHOST</code>
</p>
</td>
<td valign="top">
<p>
下载插件时是用的 HTTPS 代理主机。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">HTTPSPROXYPORT</code>
</p>
</td>
<td valign="top">
<p>
下载插件时是用的 HTTPS 代理的端口。

默认为 <code class="literal">443</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">HTTPPROXYHOST</code>
</p>
</td>
<td valign="top">
<p>
下载插件时是用的 HTTP 代理主机。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">HTTPPROXYPORT</code>
</p>
</td>
<td valign="top">
<p>
下载插件时是用的 HTTP 代理的端口。

默认为 <code class="literal">80</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">XPACKLICENSE</code>
</p>
</td>
<td valign="top">
<p>
要安装的许可证的类型，<code class="literal">Basic</code> 或者 <code class="literal">Trial</code>。

默认为 <code class="literal">Basic</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">XPACKSECURITYENABLED</code>
</p>
</td>
<td valign="top">
<p>
当使用 <code class="literal">Trial</code> 许可证安装时，是否启用安全特性。

默认为 <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">BOOTSTRAPPASSWORD</code>
</p>
</td>
<td valign="top">
<p>
当安装时使用 <code class="literal">Trial</code> 许可证且启用了安全特性，用于引导集群并以 <code class="literal">bootstrap.password</code> 存储到秘钥库中的密码。

默认是一个随机值。
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">SKIPSETTINGPASSWORDS</code>
</p>
</td>
<td valign="top">
<p>
当安装时使用 <code class="literal">Trial</code> 许可证且启用了安全特性，安装程序是否应该跳过设置内置用户。

默认为 <code class="literal">false</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">ELASTICUSERPASSWORD</code>
</p>
</td>
<td valign="top">
<p>
当安装时使用 <code class="literal">Trial</code> 许可证且启用了安全特性，内置用户<code class="literal">elastic</code>的密码。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">KIBANAUSERPASSWORD</code>
</p>
</td>
<td valign="top">
<p>
当安装时使用 <code class="literal">Trial</code> 许可证且启用了安全特性，内置用户<code class="literal">kibana</code>的密码。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">LOGSTASHSYSTEMUSERPASSWORD</code>
</p>
</td>
<td valign="top">
<p>
当安装时使用 <code class="literal">Trial</code> 许可证且启用了安全特性，内置用户<code class="literal">logstash_system</code>的密码。

默认为 <code class="literal">""</code>
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>
要传递一个值，可以简单的按 <code class="literal">&lt;PROPERTYNAME&gt;="&lt;VALUE&gt;"</code> 格式把属性名称及其值附加到安装命令上。

比如，要使用不同于默认安装目录的安装目录：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /i elasticsearch-7.7.1.msi /qn INSTALLDIR="C:\Custom Install Directory{version}"</pre>
</div>
<p>
有关包含引号的值的其他规则，参考 <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa367988(v=vs.85).aspx" class="ulink" target="_top">Windows Installer SDK 命令行选项</a>。
</p>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="msi-installer-enable-indices"></a>
开启自动创建系统索引
</h3>
</div></div></div>
<p>
一些商业特性会自动在 Elasticearch 中创建索引。

默认情况下，Elasticsearch 被配置为允许自动创建索引，并且不需要其他步骤。

但是，如果在 Elasticsearch 中禁用了自动索引创建，则必须在 <code class="literal">elasticsearch.yml</code> 文件中配置 <a class="xref" href="docs-index_.html#index-creation" title="Create indices automatically"><code class="literal">action.auto_create_index</code></a>，以允许商业特性创建以下索引：
</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">action.auto_create_index: .monitoring*,.watches,.triggered_watches,.watcher-history*,.ml*</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>
如果你正在使用 <a href="https://www.elastic.co/products/logstash" class="ulink" target="_top">Logstash</a> 或 <a href="https://www.elastic.co/products/beats" class="ulink" target="_top">Beats</a>，那么你很可能在 <code class="literal">action.auto_create_index</code> 设置中需要额外的索引名，并且这个确切的值将取决于你的本地配置。

如果不确定环境的正确值，可以考虑将值设置为<code class="literal">*</code>，这将允许自动创建所有索引。
 </p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="msi-installer-command-line-running"></a>
从命令行运行 Elasticsearch
</h3>
</div></div></div>
<p>
安装好后，就可以从命令行启动 Elasticsearch；如果不是作为服务安装或未配置为安装完成时启动，可以这样操作：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">.\bin\elasticsearch.exe</pre>
</div>
<p>
命令行终端会显示类似下面这样的信息：
</p>
<div class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/elasticsearch_exe.png" alt="elasticsearch exe">
</div>
</div>
<p>
默认情况下，Elasticsearch 在前台运行，日志是打印到<code class="literal">LOGSDIRECTORY</code>目录下的文件名为 <code class="literal">&lt;cluster name&gt;.log</code> 的标准输出(<code class="literal">STDOUT</code>)，并且可以通过按 <code class="literal">Ctrl-C</code>来停止运行。
</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="msi-installer-command-line-configuration"></a>
用命令行配置 Elasticsearch
</h3>
</div></div></div>
<p>
Elasticsearch 默认从 <code class="literal">%ES_PATH_CONF%\elasticsearch.yml</code> 文件加载配置。

<a class="xref" href="settings.html" title="Configuring Elasticsearch"><em>配置 Elasticsearch</em></a> 中解释了此配置文件的格式。
</p>
<p>
任何一个可以在配置文件中指定的设置，都可以在命令行中使用<code class="literal">-E</code>语法指定，如下所示：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">.\bin\elasticsearch.exe -E cluster.name=my_cluster -E node.name=node_1</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>
包含空格的值必须用引号括起来。比如 <code class="literal">-E path.logs="C:\My Logs\logs"</code> 。
</p>
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>
通常，任何集群范围的设置(如<code class="literal">cluster.name</code>)都应该添加到 <code class="literal">elasticsearch.yml</code> 配置文件中，而任何特定于节点的设置(如<code class="literal">node.name</code>)都可以在命令行中指定。
</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="_checking_that_elasticsearch_is_running_3"></a>
检查 Elasticearch 是否正在运行
</h3>
</div></div></div>
<p>
你可以通过向 <code class="literal">localhost</code> 上的端口 <code class="literal">9200</code> 发送一个 HTTP 请求来测试 Elasticsearch 节点是否正在运行：
</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /</pre>
</div>
<div class="console_widget" data-snippet="snippets/17.console"></div>
<p>
应该会给你一个类似下面这样的响应：
</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "name" : "Cp8oag6",
  "cluster_name" : "elasticsearch",
  "cluster_uuid" : "AT69_T_DTp-1qgIJlatQqA",
  "version" : {
    "number" : "7.7.1",
    "build_flavor" : "default",
    "build_type" : "tar",
    "build_hash" : "f27399d",
    "build_date" : "2016-03-30T09:51:41.449Z",
    "build_snapshot" : false,
    "lucene_version" : "8.5.1",
    "minimum_wire_compatibility_version" : "1.2.3",
    "minimum_index_compatibility_version" : "1.2.3"
  },
  "tagline" : "You Know, for Search"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="msi-installer-windows-service"></a>
在 Windows 上将 Elasticsearch 作为服务安装
</h3>
</div></div></div>
<p>
Elasticsearch可以作为服务安装在后台运行，也可以在启动时自动启动，无需任何用户交互。

这可以通过在安装时使用以下命令行选项来实现:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">INSTALLASSERVICE=true</code>
</li>
<li class="listitem">
<code class="literal">STARTAFTERINSTALL=true</code>
</li>
<li class="listitem">
<code class="literal">STARTWHENWINDOWSSTARTS=true</code>
</li>
</ul>
</div>
<p>
安装好后，Elasticsearch 就会出现的服务控制面板中：
</p>
<div id="msi-installer-installed-service" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_installed_service.png" alt="msi installer installed service">
</div>
</div>
<p>
且可以通过控制面板来停止和重启，或者像下面这样从命令行操作：
</p>
<p>
使用命令行提示符：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sc.exe stop Elasticsearch
sc.exe start Elasticsearch</pre>
</div>
<p>
使用 PowerShell：
</p>
<div class="pre_wrapper lang-powershell">
<pre class="programlisting prettyprint lang-powershell">Get-Service Elasticsearch | Stop-Service
Get-Service Elasticsearch | Start-Service</pre>
</div>
<p>
在服务安装后，可以通过<code class="literal">jvm.options</code> 和 配置文件 <code class="literal">elasticsearch.yml</code> 来修改设置。

大多数修改（比如 JVM 设置）需要重启服务才能生效。
</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="upgrade-msi-gui"></a>
使用 图形用户界面(GUI) 升级
</h3>
</div></div></div>
<p>
<code class="literal">.msi</code> 安装包支持升级一个已安装的版本到新的版本。

在通过 GUI 升级的过程中，它会处理所有已安装插件的升级，并保留你的数据和配置。
</p>
<p>
下载并双击新版本的 <code class="literal">.msi</code> 安装包，就会启动 GUI 安装向导。

第一步会列出之前已安装版本的只读选项：
</p>
<div id="msi-installer-upgrade-notice" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_upgrade_notice.png" alt="msi installer upgrade notice">
</div>
</div>
<p>
下一步会允许你修改部分配置选项：
</p>
<div id="msi-installer-upgrade-configuration" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_upgrade_configuration.png" alt="msi installer upgrade configuration">
</div>
</div>
<p>
最后，插件操作步骤中允许你将已安装的插件升级或者移除，对于尚未安装的插件，可以下载并安装：
</p>
<div id="msi-installer-upgrade-plugins" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_upgrade_plugins.png" alt="msi installer upgrade plugins">
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="upgrade-msi-command-line"></a>
通过命令行升级
</h3>
</div></div></div>
<p>
<code class="literal">.msi</code> 安装包还可以使用命令行来升级 Elasticsearch。
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>
命令行升级需要传递与首次安装时 <span class="strong strong"><strong>相同的</strong></span> 命令行属性；Windows 安装程序不会记住这些属性。
</p>
<p>
比如，如果你之前是以命令行选项 <code class="literal">PLUGINS="ingest-geoip"</code> 和 <code class="literal">LOCKMEMORY="true"</code> 来安装的，那么你从命令行执行升级时必须传递相同的值。
</p>
<p>
参数 <code class="literal">INSTALLDIR</code>（如果原来指定了） 是一个<span class="strong strong"><strong>例外</strong></span>，这各值必须使用与当前安装版本不同的目录。

如果指定了 <code class="literal">INSTALLDIR</code>，路径的最后一个目录 <span class="strong strong"><strong>必须</strong></span> 包含必须是版本号，比如：
</p>
<p><code class="literal">C:\Program Files\Elastic\Elasticsearch\7.7.1</code></p>
</div>
</div>
<p>
最简单的升级方式是，假设 Elasticsearch 是使用所有的默认值安装的，首先导航到下载目录，然后运行:
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /i elasticsearch-7.7.1.msi /qn</pre>
</div>
<p>
与安装过程类似，可以通过命令行参数 <code class="literal">/l</code> 来指定升级过程的日志存放的路径：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /i elasticsearch-7.7.1.msi /qn /l upgrade.log</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="uninstall-msi-gui"></a>
使用 添加/删除 程序卸载 Elasticsearch
</h3>
</div></div></div>
<p>
<code class="literal">.msi</code> 安装包处理安装时建立的所有文件夹和文件夹的卸载工作。
</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>
卸载程序会移除安装时建立的 <span class="strong strong"><strong>所有</strong></span> 内容， <span class="strong strong"><strong>除了 数据、配置和日志目录</strong></span>。

建议在升级前给数据目录做个备份，或者使用 快照(snapshot) API。
</p>
</div>
</div>
<p>
MSI 安装包没有提供卸载的 GUI。

已安装的程序，可以通过按 Windows 徽标键然后输入 <code class="literal">添加或删除程序</code> 来打开设置管理。
</p>
<p>
打开后，在已安装应用的列表中找到 Elasticsearch，点击并选择 <code class="literal">卸载</code>：
</p>
<div id="msi-installer-uninstall" class="imageblock">
<div class="content">
<img src="../static/images/msi_installer/msi_installer_uninstall.png" alt="msi installer uninstall">
</div>
</div>
<p>
这将启动卸载程序。
</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="uninstall-msi-command-line"></a>
使用命令行卸载 ElasticSearch
</h3>
</div></div></div>
<p>
卸载 ElasticSearch 还可以使用命令, 先切换到包含 <code class="literal">.msi</code> 安装包的目录，然后执行：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /x elasticsearch-7.7.1.msi /qn</pre>
</div>
<p>
与安装过程类似，可以通过命令行参数 <code class="literal">/l</code> 来指定卸载过程的日志存放的路径：
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">start /wait msiexec.exe /x elasticsearch-7.7.1.msi /qn /l uninstall.log</pre>
</div>
</div>

<div class="section exclude">
<div class="titlepage"><div><div>
<h3 class="title">
<a id="_next_steps_5"></a>
下一步
</h3>
</div></div></div>
<p>
你现在已经设置了一个 Elasticsearch 测试环境。

在开始正式开发或开始使用 Elasticsearch 进行生产之前，你还必须做一些额外的设置：
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
学习如何 <a class="xref" href="settings.html" title="Configuring Elasticsearch">配置 Elasticsearch</a>。
</li>
<li class="listitem">
配置 <a class="xref" href="important-settings.html" title="Important Elasticsearch configuration">重要的 Elasticsearch 设置</a>。
</li>
<li class="listitem">
配置 <a class="xref" href="system-config.html" title="Important System Configuration">重要的系统设置</a>。
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="rpm.html">« 使用RPM安装包安装 Elasticsearch</a>
</span>
<span class="next">
<a href="docker.html">用Docker安装 Elasticsearch »</a>
</span>
</div>
</div>

                  <!-- end body -->
                        </div>
                        <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                        
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </section>
</div>
<script src="../static/cn.js"></script>
</body>
</html>